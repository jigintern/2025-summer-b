<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style-thread.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Outfit:wght@100..900&display=swap"
        rel="stylesheet">
    <title>掲示板</title>
</head>

<body>
    <a href="index.html">掲示板一覧へ戻る</a>
    <h1 id="title"></h1>
    <!-- 投稿を表示するエリア -->
    <div id="posts"></div>

    <!-- 入力フォーム -->
    <div class="form-container">
        <h2>新しい投稿</h2>
        <!-- 名前入力欄 -->
        <input type="text" id="userName" value="名無し" placeholder="名前を入力">
        <!-- 投稿内容入力欄 -->
        <textarea id="postContent" rows="4" placeholder="投稿内容を入力"></textarea>
        <!-- 送信ボタン -->
        <button id="submitBtn">送信</button>
    </div>

    <script>
        const queryString = window.location.search;
        const params = new URLSearchParams(queryString);
        const title = params.get("title");

        console.log(queryString);
        console.log(params);
        console.log(title);

        const titleElement = document.getElementById("title");

        if (title) {
            titleElement.textContent = title;
        } else {
            titleElement.textContent = "掲示板";
        }

        // --- 仮のサーバーから返ってくるデータ（実際にはAPIなどから取得予定） ---
        const posts = [
            { userName: "田中", post: "こんにちは！", createdAt: "2025-08-21 10:00" },
            { userName: "佐藤", post: "今日はいい天気ですね。", createdAt: "2025-08-21 11:30" },
            { userName: "鈴木", post: "明日の予定はどうですか？", createdAt: "2025-08-21 12:00" },
            { userName: "高橋", post: "新しい映画が公開されました！", createdAt: "2025-08-21 13:15" },
            { userName: "伊藤", post: "週末に旅行に行きます。", createdAt: "2025-08-21 14:45" },
            { userName: "渡辺", post: "最近読んだ本が面白かったです。", createdAt: "2025-08-21 15:20" },
            { userName: "山本", post: "スポーツ観戦が好きです。", createdAt: "2025-08-21 16:05" },
            { userName: "中村", post: "新しいレストランを見つけました。", createdAt: "2025-08-21 17:30" },
            { userName: "小林", post: "音楽フェスに行きたいです。", createdAt: "2025-08-21 18:10" },
            { userName: "加藤", post: "最近ハマっているゲームがあります。", createdAt: "2025-08-21 19:00" }
        ];

        // 投稿を表示する親要素
        const postsContainer = document.getElementById("posts");

        // --- 投稿をHTMLに描画する関数 ---
        function renderPosts() {
            // いったん中身をクリア
            postsContainer.innerHTML = "";
            // 配列の内容を順に表示
            posts.forEach(p => {
                const div = document.createElement("div"); // 投稿全体のdivを作成
                div.className = "post"; // CSS用クラスを付与
                div.innerHTML = `
                    <div>    
                        <div class="user">${p.userName}</div>
                        <div class="content">${p.post}</div>
                    </div>
                    <div class="date">${p.createdAt}</div>
                `;
                postsContainer.appendChild(div); // 親要素に追加
            });
        }

        // ページ読み込み時に仮データを描画
        renderPosts();

        // --- 送信ボタンが押されたときの処理 ---
        document.getElementById("submitBtn").addEventListener("click", () => {
            // 入力値を取得
            const userName = document.getElementById("userName").value.trim();
            const postContent = document.getElementById("postContent").value.trim();

            // 入力が空ならアラートを表示して処理を中断
            if (!postContent) {
                alert("投稿内容を入力してください");
                return;
            }

            // 現在時刻を投稿時刻として使う
            const now = new Date();
            const createdAt = now.toLocaleString(); // 例: 2025/8/21 15:30:00

            // 新しい投稿を配列に追加
            posts.push({ userName, post: postContent, createdAt });

            // 再描画して新しい投稿を反映
            renderPosts();

            // 入力欄をリセット
            document.getElementById("userName").value = "";
            document.getElementById("postContent").value = "";
        });
    </script>
</body>

</html>